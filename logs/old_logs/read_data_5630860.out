Torch version: 2.5.1
CUDA available: True
CUDA device count: 2
CUDA device name: NVIDIA H100 80GB HBM3
Loading year 2001

[Cache] Loaded dataset from cache/precip_patch_dataset_2001_isp_ag_multi_patch.pkl

Loading year 2002
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 64: kept 9.44603365014918% (15355/162555) patches after IS, discarded 147200
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 128: kept 8.936248476906453% (3887/43497) patches after IS, discarded 39610
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 6.168895682078716% (4036/65425) patches after IS, discarded 61389
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 512: kept 5.684931506849315% (249/4380) patches after IS, discarded 4131
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 896: kept 6.575342465753424% (72/1095) patches after IS, discarded 1023
[LogScaler] Auto-selected c = 0.1000
[LogScaler] mean=0.8555, std=1.1600
Raw values stats:
min: 0.0 max: 11.603605
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [15355, 3887, 4036, 249, 72]

[Cache] Saved dataset to cache/precip_patch_dataset_2002_isp_ag_multi_patch.pkl

Loading year 2003
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 64: kept 6.529308257727971% (10464/160262) patches after IS, discarded 149798
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 128: kept 6.3435180229446395% (2726/42973) patches after IS, discarded 40247
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.04
[PatchDiffusionDataset] Patch size 256: kept 4.080240597773851% (2632/64506) patches after IS, discarded 61874
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.04
[PatchDiffusionDataset] Patch size 512: kept 4.648473635522664% (201/4324) patches after IS, discarded 4123
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.05
[PatchDiffusionDataset] Patch size 896: kept 3.955841766329347% (43/1087) patches after IS, discarded 1044
[LogScaler] mean=0.8210, std=1.1687
Raw values stats:
min: 0.0 max: 8.599711
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [10464, 2726, 2632, 201, 43]

[Cache] Saved dataset to cache/precip_patch_dataset_2003_isp_ag_multi_patch.pkl

Loading year 2004
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1098 timesteps assigned
  Patch size 128: 1098 timesteps assigned
  Patch size 256: 4392 timesteps assigned
  Patch size 512: 1098 timesteps assigned
  Patch size 896: 1098 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 64: kept 8.597204915829852% (14075/163716) patches after IS, discarded 149641
[PatchDiffusionDataset] Extracting patches of size 128 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.08
[PatchDiffusionDataset] Patch size 128: kept 8.386387578436311% (3662/43666) patches after IS, discarded 40004
[PatchDiffusionDataset] Extracting patches of size 256 from 4392 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 5.667634583517035% (3728/65777) patches after IS, discarded 62049
[PatchDiffusionDataset] Extracting patches of size 512 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.05
[PatchDiffusionDataset] Patch size 512: kept 5.031876138433516% (221/4392) patches after IS, discarded 4171
[PatchDiffusionDataset] Extracting patches of size 896 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 896: kept 6.284153005464481% (69/1098) patches after IS, discarded 1029
[LogScaler] mean=0.7852, std=1.1248
Raw values stats:
min: 0.0 max: 11.209675
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [14075, 3662, 3728, 221, 69]

[Cache] Saved dataset to cache/precip_patch_dataset_2004_isp_ag_multi_patch.pkl

Loading year 2005
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 64: kept 8.703558570693836% (14215/163324) patches after IS, discarded 149109
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 128: kept 8.491819806608314% (3706/43642) patches after IS, discarded 39936
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 5.550803445958331% (3634/65468) patches after IS, discarded 61834
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.05
[PatchDiffusionDataset] Patch size 512: kept 4.794520547945205% (210/4380) patches after IS, discarded 4170
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 896: kept 7.123287671232877% (78/1095) patches after IS, discarded 1017
[LogScaler] mean=0.7306, std=1.0647
Raw values stats:
min: 0.0 max: 5.564173
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [14215, 3706, 3634, 210, 78]

[Cache] Saved dataset to cache/precip_patch_dataset_2005_isp_ag_multi_patch.pkl

Loading year 2006
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 64: kept 8.763012744488996% (13965/159363) patches after IS, discarded 145398
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 128: kept 8.58729706636286% (3618/42132) patches after IS, discarded 38514
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 5.688495407930182% (3611/63479) patches after IS, discarded 59868
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 512: kept 5.814500941619586% (247/4248) patches after IS, discarded 4001
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 896: kept 6.120527306967985% (65/1062) patches after IS, discarded 997
[LogScaler] mean=0.7699, std=1.0996
Raw values stats:
min: 0.0 max: 8.665403
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [13965, 3618, 3611, 247, 65]

[Cache] Saved dataset to cache/precip_patch_dataset_2006_isp_ag_multi_patch.pkl

Loading year 2007
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.10
[PatchDiffusionDataset] Patch size 64: kept 9.89393883724633% (16157/163302) patches after IS, discarded 147145
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.10
[PatchDiffusionDataset] Patch size 128: kept 9.718875502008032% (4235/43575) patches after IS, discarded 39340
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 256: kept 6.4710296978144% (4225/65291) patches after IS, discarded 61066
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 512: kept 6.473010064043915% (283/4372) patches after IS, discarded 4089
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 896: kept 6.868131868131868% (75/1092) patches after IS, discarded 1017
[LogScaler] mean=0.9106, std=1.1622
Raw values stats:
min: 0.0 max: 12.49126
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [16157, 4235, 4225, 283, 75]

[Cache] Saved dataset to cache/precip_patch_dataset_2007_isp_ag_multi_patch.pkl

Loading year 2008
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1098 timesteps assigned
  Patch size 128: 1098 timesteps assigned
  Patch size 256: 4392 timesteps assigned
  Patch size 512: 1098 timesteps assigned
  Patch size 896: 1098 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 64: kept 8.822629782340059% (14422/163466) patches after IS, discarded 149044
[PatchDiffusionDataset] Extracting patches of size 128 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 128: kept 8.637790045124493% (3771/43657) patches after IS, discarded 39886
[PatchDiffusionDataset] Extracting patches of size 256 from 4392 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 5.910006715916722% (3872/65516) patches after IS, discarded 61644
[PatchDiffusionDataset] Extracting patches of size 512 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.05
[PatchDiffusionDataset] Patch size 512: kept 5.942622950819672% (261/4392) patches after IS, discarded 4131
[PatchDiffusionDataset] Extracting patches of size 896 from 1098 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 896: kept 6.193078324225866% (68/1098) patches after IS, discarded 1030
[LogScaler] mean=0.7680, std=1.0920
Raw values stats:
min: 0.0 max: 14.055225
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [14422, 3771, 3872, 261, 68]

[Cache] Saved dataset to cache/precip_patch_dataset_2008_isp_ag_multi_patch.pkl

Loading year 2009
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.10
[PatchDiffusionDataset] Patch size 64: kept 9.52053194243605% (15077/158363) patches after IS, discarded 143286
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 128: kept 8.770690588872407% (3725/42471) patches after IS, discarded 38746
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 6.07524268038327% (3874/63767) patches after IS, discarded 59893
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 512: kept 5.669144981412639% (244/4304) patches after IS, discarded 4060
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 896: kept 7.182835820895522% (77/1072) patches after IS, discarded 995
[LogScaler] mean=0.7561, std=1.0714
Raw values stats:
min: 0.0 max: 12.8094845
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [15077, 3725, 3874, 244, 77]

[Cache] Saved dataset to cache/precip_patch_dataset_2009_isp_ag_multi_patch.pkl

Loading year 2010
[PatchDiffusionDataset] Timestep splits per patch size:
  Patch size 64: 1095 timesteps assigned
  Patch size 128: 1095 timesteps assigned
  Patch size 256: 4380 timesteps assigned
  Patch size 512: 1095 timesteps assigned
  Patch size 896: 1095 timesteps assigned
[PatchDiffusionDataset] Extracting patches of size 64 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 64
[PatchDiffusionDataset] Patch size 64 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 64: kept 9.43684256066056% (15269/161802) patches after IS, discarded 146533
[PatchDiffusionDataset] Extracting patches of size 128 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 128
[PatchDiffusionDataset] Patch size 128 Kept patches fraction (expected) = 0.09
[PatchDiffusionDataset] Patch size 128: kept 8.967019723271607% (3869/43147) patches after IS, discarded 39278
[PatchDiffusionDataset] Extracting patches of size 256 from 4380 timesteps
[Warning] Found NaNs in patches for patch size 256
[PatchDiffusionDataset] Patch size 256 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 256: kept 6.25971348115777% (4068/64987) patches after IS, discarded 60919
[PatchDiffusionDataset] Extracting patches of size 512 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 512
[PatchDiffusionDataset] Patch size 512 Kept patches fraction (expected) = 0.06
[PatchDiffusionDataset] Patch size 512: kept 5.922865013774104% (258/4356) patches after IS, discarded 4098
[PatchDiffusionDataset] Extracting patches of size 896 from 1095 timesteps
[Warning] Found NaNs in patches for patch size 896
[PatchDiffusionDataset] Patch size 896 Kept patches fraction (expected) = 0.07
[PatchDiffusionDataset] Patch size 896: kept 7.155963302752293% (78/1090) patches after IS, discarded 1012
[LogScaler] mean=0.8413, std=1.1150
Raw values stats:
min: 0.0 max: 6.767061
NaNs: 0 Infs: 0
[PatchDiffusionDataset] total path_sets = 5 with lengths [15269, 3869, 4068, 258, 78]

[Cache] Saved dataset to cache/precip_patch_dataset_2010_isp_ag_multi_patch.pkl

