#######################################################################################
### conda added to PATH. Use 'source activate' rather than 'conda activate'.        ###
### Do not run 'conda init' if prompted.                                            ###
### 'conda init' will modify your shell outside of the `module` environment         ###
#######################################################################################
[I 2025-10-28 16:12:18,985] A new study created in RDB with name: rain_diffusion_1761664338
/home/merlinho/testspace/DDPM_Inpainting/src/save/save_plot.py:58: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.
  plt.tight_layout()
[W 2025-10-28 16:29:06,227] Trial 0 failed with parameters: {'model_channels': 256, 'num_blocks': 1, 'dropout': 0.10977520275575751, 'downsample_type': 'residual', 'channel_mult': '124', 'attn_config': 'last', 'timesteps': 1000, 'beta_schedule': 'exponential', 'loss': 'l1', 'optimizer': 'AdamW', 'scheduler': 'WarmupCosine', 'lr': 0.0001480883022381527} because of the following error: RuntimeError('Parent directory output_new/new_run/trials does not exist.').
Traceback (most recent call last):
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 135, in <lambda>
    study.optimize(lambda trial: objective(trial, loader=loader, run_dir=run_dir, max_epochs=max_epochs, patience=patience), n_trials=n_trials)
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 107, in objective
    torch.save(unet.state_dict(), ckpt_name)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/torch/serialization.py", line 849, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/torch/serialization.py", line 716, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/torch/serialization.py", line 687, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: Parent directory output_new/new_run/trials does not exist.
[W 2025-10-28 16:29:06,232] Trial 0 failed with value None.
Traceback (most recent call last):
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna_best.py", line 94, in <module>
    diffusion, unet, best_loss, params = run_optuna_best(n_trials=n_trials,
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna_best.py", line 74, in run_best_optuna
    param_filename, model_filename = run_optuna(n_trials=n_trials, 
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 135, in run_optuna
    study.optimize(lambda trial: objective(trial, loader=loader, run_dir=run_dir, max_epochs=max_epochs, patience=patience), n_trials=n_trials)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 135, in <lambda>
    study.optimize(lambda trial: objective(trial, loader=loader, run_dir=run_dir, max_epochs=max_epochs, patience=patience), n_trials=n_trials)
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 107, in objective
    torch.save(unet.state_dict(), ckpt_name)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/torch/serialization.py", line 849, in save
    with _open_zipfile_writer(f) as opened_zipfile:
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/torch/serialization.py", line 716, in _open_zipfile_writer
    return container(name_or_buffer)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/torch/serialization.py", line 687, in __init__
    super().__init__(torch._C.PyTorchFileWriter(self.name))
RuntimeError: Parent directory output_new/new_run/trials does not exist.
