
[Cache] Loaded dataset from cache/precip_dataset_2001-2017_256_8760_10%.pkl

Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot73.png
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot74.png
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot75.png
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot76.png
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot77.png
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot78.png
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot79.png
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot80.png
Using 2 GPUs via DataParallel
<built-in function getcwd>
[Plot] Saved output/plots/plot81.png
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Using 2 GPUs via DataParallel
Best params: {'model_channels': 256, 'num_blocks': 2, 'dropout': 0.16193626212824253, 'downsample_type': 'residual', 'channel_mult': '124', 'attn_config': 'last', 'timesteps': 1000, 'beta_schedule': 'linear', 'loss': 'mse', 'optimizer': 'AdamW', 'scheduler': 'WarmupCosine', 'lr': 0.00013388681048907052}
Best value: 0.013357496789434452
Best params saved to: output/params/best_params_0.0134_1014_17.csv
Best model saved to: output/models/best_model_0.0134_1014_17.pt





=== Parameter-wise Summary ===

Parameter: model_channels
  128: avg RMSE=0.0566, avg time=infs over 108 trials
  64: avg RMSE=0.0548, avg time=infs over 84 trials
  256: avg RMSE=0.0514, avg time=infs over 408 trials

Parameter: num_blocks
  3: avg RMSE=0.0527, avg time=infs over 132 trials
  1: avg RMSE=0.0304, avg time=7237.9s over 108 trials
  2: avg RMSE=0.0596, avg time=infs over 360 trials

Parameter: dropout
  0.03610318728639593: avg RMSE=0.0482, avg time=11277.4s over 12 trials
  0.27036080837044113: avg RMSE=0.0488, avg time=15725.7s over 12 trials
  0.05536966738119307: avg RMSE=0.0756, avg time=2783.5s over 12 trials
  0.1817467557101298: avg RMSE=0.0503, avg time=4765.0s over 12 trials
  0.13265442921898646: avg RMSE=0.0620, avg time=29023.9s over 12 trials
  0.017105870498949037: avg RMSE=0.0178, avg time=15226.8s over 12 trials
  0.08371425804778473: avg RMSE=0.0485, avg time=12914.5s over 12 trials
  0.19969677482930373: avg RMSE=0.0821, avg time=infs over 12 trials
  0.020659128727552: avg RMSE=0.1173, avg time=infs over 12 trials
  0.11546200662731894: avg RMSE=0.0197, avg time=6268.7s over 12 trials
  0.24557712387593195: avg RMSE=0.0183, avg time=3775.3s over 12 trials
  0.26395758063186125: avg RMSE=0.0184, avg time=3788.6s over 12 trials
  0.20514219213011828: avg RMSE=0.0317, avg time=3774.7s over 12 trials
  0.29652988563450583: avg RMSE=0.9964, avg time=infs over 12 trials
  0.23315352910302045: avg RMSE=0.0188, avg time=11399.5s over 12 trials
  0.001241896355114798: avg RMSE=0.0201, avg time=3409.0s over 12 trials
  0.1535071206394072: avg RMSE=0.0264, avg time=37525.2s over 12 trials
  0.07990942729760817: avg RMSE=0.0228, avg time=16218.9s over 12 trials
  0.16705070276570103: avg RMSE=0.0176, avg time=16072.8s over 12 trials
  0.16193626212824253: avg RMSE=0.0134, avg time=27261.6s over 12 trials
  0.16592660207390966: avg RMSE=0.0343, avg time=infs over 12 trials
  0.1128709484044096: avg RMSE=0.0185, avg time=8169.1s over 12 trials
  0.1365995609567538: avg RMSE=0.0135, avg time=27217.2s over 12 trials
  0.14090241215286947: avg RMSE=0.0137, avg time=16320.7s over 12 trials
  0.12485154265973498: avg RMSE=0.0301, avg time=infs over 12 trials
  0.08144134183703464: avg RMSE=0.0484, avg time=infs over 12 trials
  0.14511779695637703: avg RMSE=0.0139, avg time=16403.9s over 12 trials
  0.21038762090777857: avg RMSE=0.0137, avg time=27247.4s over 12 trials
  0.10033106262486935: avg RMSE=0.1235, avg time=infs over 12 trials
  0.18501622816194443: avg RMSE=0.0334, avg time=infs over 12 trials
  0.05432926916116522: avg RMSE=0.0509, avg time=infs over 12 trials
  0.20729718165644587: avg RMSE=0.0138, avg time=19039.6s over 12 trials
  0.2194566921042495: avg RMSE=0.0139, avg time=19037.4s over 12 trials
  0.14815574847659907: avg RMSE=0.0140, avg time=16315.5s over 12 trials
  0.17482260663876453: avg RMSE=0.0138, avg time=16154.5s over 12 trials
  0.13562255557236524: avg RMSE=0.0347, avg time=infs over 12 trials
  0.09951709482845081: avg RMSE=0.0328, avg time=infs over 12 trials
  0.1866843017747969: avg RMSE=0.0136, avg time=25841.1s over 12 trials
  0.1883140000671525: avg RMSE=0.0561, avg time=infs over 12 trials
  0.15857354087677256: avg RMSE=0.0290, avg time=infs over 12 trials
  0.13795914957359293: avg RMSE=0.0708, avg time=infs over 12 trials
  0.23067623560222417: avg RMSE=0.0135, avg time=20498.7s over 12 trials
  0.23525505589273976: avg RMSE=0.0136, avg time=20510.2s over 12 trials
  0.23998524301512864: avg RMSE=0.0134, avg time=16356.8s over 12 trials
  0.26412472109846746: avg RMSE=0.0138, avg time=14378.9s over 12 trials
  0.24389962073593008: avg RMSE=0.0259, avg time=infs over 12 trials
  0.28755053904822714: avg RMSE=0.0292, avg time=infs over 12 trials
  0.2761024745050802: avg RMSE=0.0146, avg time=7987.2s over 12 trials
  0.2308227664457092: avg RMSE=0.0448, avg time=infs over 12 trials
  0.2522679159299011: avg RMSE=0.0325, avg time=infs over 12 trials

Parameter: downsample_type
  residual: avg RMSE=0.0336, avg time=infs over 480 trials
  standard: avg RMSE=0.1298, avg time=infs over 120 trials

Parameter: channel_mult
  1224: avg RMSE=0.0349, avg time=infs over 204 trials
  1248: avg RMSE=0.0431, avg time=infs over 60 trials
  124: avg RMSE=0.0332, avg time=infs over 264 trials
  1124: avg RMSE=0.1841, avg time=infs over 72 trials

Parameter: attn_config
  none: avg RMSE=0.0408, avg time=infs over 96 trials
  last_two: avg RMSE=0.1180, avg time=infs over 144 trials
  last: avg RMSE=0.0300, avg time=infs over 360 trials

Parameter: timesteps
  500: avg RMSE=0.0470, avg time=infs over 108 trials
  250: avg RMSE=0.0579, avg time=infs over 84 trials
  1000: avg RMSE=0.0534, avg time=infs over 408 trials

Parameter: beta_schedule
  exponential: avg RMSE=0.0587, avg time=infs over 120 trials
  linear: avg RMSE=0.0544, avg time=infs over 360 trials
  quadratic: avg RMSE=0.0501, avg time=infs over 60 trials
  cosine: avg RMSE=0.0347, avg time=infs over 60 trials

Parameter: loss
  huber: avg RMSE=0.0314, avg time=infs over 228 trials
  l1: avg RMSE=0.1696, avg time=infs over 84 trials
  mse: avg RMSE=0.0358, avg time=infs over 288 trials

Parameter: optimizer
  AdamW: avg RMSE=0.0552, avg time=infs over 468 trials
  Adam: avg RMSE=0.0445, avg time=infs over 132 trials

Parameter: scheduler
  ExponentialLR: avg RMSE=0.0262, avg time=infs over 288 trials
  WarmupCosine: avg RMSE=0.0774, avg time=infs over 312 trials

Parameter: lr
  5.299361330754155e-05: avg RMSE=0.0482, avg time=11277.4s over 12 trials
  7.05610984259019e-05: avg RMSE=0.0488, avg time=15725.7s over 12 trials
  0.0024407157788259265: avg RMSE=0.0756, avg time=2783.5s over 12 trials
  1.0624357481333449e-05: avg RMSE=0.0503, avg time=4765.0s over 12 trials
  0.0003039072047092761: avg RMSE=0.0620, avg time=29023.9s over 12 trials
  0.00034181982291816486: avg RMSE=0.0178, avg time=15226.8s over 12 trials
  3.589028779491149e-05: avg RMSE=0.0485, avg time=12914.5s over 12 trials
  0.00023185577925624462: avg RMSE=0.0821, avg time=infs over 12 trials
  1.297989162932501e-05: avg RMSE=0.1173, avg time=infs over 12 trials
  5.582213657374248e-05: avg RMSE=0.0197, avg time=6268.7s over 12 trials
  0.0009409795564083897: avg RMSE=0.0183, avg time=3775.3s over 12 trials
  0.0011188557337521955: avg RMSE=0.0184, avg time=3788.6s over 12 trials
  0.00072642722955238: avg RMSE=0.0317, avg time=3774.7s over 12 trials
  0.004801590666425502: avg RMSE=0.9964, avg time=infs over 12 trials
  0.0005364056564791141: avg RMSE=0.0188, avg time=11399.5s over 12 trials
  0.0016888788442601496: avg RMSE=0.0201, avg time=3409.0s over 12 trials
  0.00012941520400811226: avg RMSE=0.0264, avg time=37525.2s over 12 trials
  0.00034169209774123535: avg RMSE=0.0228, avg time=16218.9s over 12 trials
  0.0005881413016982928: avg RMSE=0.0176, avg time=16072.8s over 12 trials
  0.00013388681048907052: avg RMSE=0.0134, avg time=27261.6s over 12 trials
  0.00012977643029728417: avg RMSE=0.0343, avg time=infs over 12 trials
  0.000516389497116576: avg RMSE=0.0185, avg time=8169.1s over 12 trials
  0.00013680268777888478: avg RMSE=0.0135, avg time=27217.2s over 12 trials
  0.00012381016822449837: avg RMSE=0.0137, avg time=16320.7s over 12 trials
  0.0001328248945318132: avg RMSE=0.0301, avg time=infs over 12 trials
  2.7865072527399297e-05: avg RMSE=0.0484, avg time=infs over 12 trials
  9.265402244552375e-05: avg RMSE=0.0139, avg time=16403.9s over 12 trials
  0.00017688279404234485: avg RMSE=0.0137, avg time=27247.4s over 12 trials
  2.1520024467181543e-05: avg RMSE=0.1235, avg time=infs over 12 trials
  8.96253425572923e-05: avg RMSE=0.0334, avg time=infs over 12 trials
  4.473722627051791e-05: avg RMSE=0.0509, avg time=infs over 12 trials
  0.00020036577710939426: avg RMSE=0.0138, avg time=19039.6s over 12 trials
  0.0001859701275361859: avg RMSE=0.0139, avg time=19037.4s over 12 trials
  9.918533485840888e-05: avg RMSE=0.0140, avg time=16315.5s over 12 trials
  0.0001659531871432465: avg RMSE=0.0138, avg time=16154.5s over 12 trials
  6.950962573433623e-05: avg RMSE=0.0347, avg time=infs over 12 trials
  0.0002657996846543532: avg RMSE=0.0328, avg time=infs over 12 trials
  0.00015053941434115388: avg RMSE=0.0136, avg time=25841.1s over 12 trials
  6.769379285183504e-05: avg RMSE=0.0561, avg time=infs over 12 trials
  0.00010977414868622916: avg RMSE=0.0290, avg time=infs over 12 trials
  0.00040138536420340293: avg RMSE=0.0708, avg time=infs over 12 trials
  0.00016247320148743896: avg RMSE=0.0135, avg time=20498.7s over 12 trials
  0.0001490306154925668: avg RMSE=0.0136, avg time=20510.2s over 12 trials
  0.00015147088758229896: avg RMSE=0.0134, avg time=16356.8s over 12 trials
  0.00022908646399196636: avg RMSE=0.0138, avg time=14378.9s over 12 trials
  7.846320071990418e-05: avg RMSE=0.0259, avg time=infs over 12 trials
  0.00015194838061146135: avg RMSE=0.0292, avg time=infs over 12 trials
  0.0002639551366766013: avg RMSE=0.0146, avg time=7987.2s over 12 trials
  0.0002227654541066773: avg RMSE=0.0448, avg time=infs over 12 trials
  5.7927331330257606e-05: avg RMSE=0.0325, avg time=infs over 12 trials

[Cache] Loaded dataset from cache/precip_dataset_2001-2017_256_8760_10%.pkl

Using 2 GPUs via DataParallel
Epoch 1/150 - avg_loss: 0.013484, avg_rmse: 0.013460
Epoch 2/150 - avg_loss: 0.013836, avg_rmse: 0.013790
Epoch 3/150 - avg_loss: 0.014056, avg_rmse: 0.013988
Epoch 4/150 - avg_loss: 0.014147, avg_rmse: 0.014091
Epoch 5/150 - avg_loss: 0.013873, avg_rmse: 0.013815
Early stopping at epoch 5
Best params: {'model_channels': 256, 'num_blocks': 2, 'dropout': 0.1619362621282425, 'downsample_type': 'residual', 'channel_mult': 124, 'attn_config': 'last', 'timesteps': 1000, 'beta_schedule': 'linear', 'loss': 'mse', 'optimizer': 'AdamW', 'scheduler': 'WarmupCosine', 'lr': 0.000133886810489, 'loss_value': 0.0133574967894344}
Best value: 0.013459902237489428
Best params saved to: output/params/best_params_0.0135_1014_21.csv
Best model saved to: output/models/best_model_0.0135_1014_21.pt




