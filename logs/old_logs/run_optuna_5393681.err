#######################################################################################
### conda added to PATH. Use 'source activate' rather than 'conda activate'.        ###
### Do not run 'conda init' if prompted.                                            ###
### 'conda init' will modify your shell outside of the `module` environment         ###
#######################################################################################
[I 2025-11-12 16:25:43,961] A new study created in RDB with name: rain_diffusion_1762961142
[W 2025-11-12 16:25:45,390] Trial 0 failed with parameters: {'model_channels': 128, 'num_blocks': 1, 'dropout': 0.21773224253287082, 'downsample_type': 'standard', 'channel_mult': '1248', 'attn_config': 'last'} because of the following error: NameError("name 'device' is not defined").
Traceback (most recent call last):
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 198, in <lambda>
    study.optimize(lambda trial: objective(trial, loader=loader, run_dir=run_dir, max_epochs=max_epochs, patience=patience), n_trials=n_trials, n_jobs=1)#torch.cuda.device_count())
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 132, in objective
    ).to(device)
NameError: name 'device' is not defined
[W 2025-11-12 16:25:45,392] Trial 0 failed with value None.
Traceback (most recent call last):
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 232, in <module>
    unet, best_loss, params = run_optuna()
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 198, in run_optuna
    study.optimize(lambda trial: objective(trial, loader=loader, run_dir=run_dir, max_epochs=max_epochs, patience=patience), n_trials=n_trials, n_jobs=1)#torch.cuda.device_count())
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/merlinho/.conda/envs/diffusion_rain/lib/python3.10/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 198, in <lambda>
    study.optimize(lambda trial: objective(trial, loader=loader, run_dir=run_dir, max_epochs=max_epochs, patience=patience), n_trials=n_trials, n_jobs=1)#torch.cuda.device_count())
  File "/home/merlinho/testspace/DDPM_Inpainting/src/run/run_optuna.py", line 132, in objective
    ).to(device)
NameError: name 'device' is not defined. Did you mean: 'device_id'?
